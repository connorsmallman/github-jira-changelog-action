{"version":3,"sources":["../../src/Config.js"],"names":["CONF_FILENAME","getDefaultConfig","defaultConfig","configFilePath","cwd","program","config","path","resolve","join","readConfigFile","localConf","configPath","fs","accessSync","require","e","SyntaxError","console","log","stack","message","defaultValues","defaults","Object","entries","forEach","key","defVal","Array","isArray","assign"],"mappings":";;;;;;;;;;;AAOA;;AACA;;AACA;;AAKA;;;;AAdA;;;;;;;AAWA;;;;AAMA;;;;AAIO,MAAMA,aAAa,GAAG,qBAAtB;AAEP;;;;;;;AAIO,SAASC,gBAAT,GAA4B;AACjC,SAAOC,wBAAP;AACD;AAED;;;;;;;AAKO,SAASC,cAAT,CAAwBC,GAAxB,EAA6B;AAClC;AACA,MAAIC,mBAAQC,MAAZ,EAAoB;AAClB,WAAOC,cAAKC,OAAL,CAAaH,mBAAQC,MAArB,CAAP;AACD;;AACD,SAAOC,cAAKE,IAAL,CAAUL,GAAV,EAAeJ,aAAf,CAAP;AACD;AAED;;;;;;;;AAMO,SAASU,cAAT,CAAwBN,GAAxB,EAA6B;AAClC,MAAIO,SAAS,GAAG,EAAhB;AACA,QAAMC,UAAU,GAAGT,cAAc,CAACC,GAAD,CAAjC;;AAEA,MAAI;AACF;AACAS,gBAAGC,UAAH,CAAcF,UAAd;;AACAD,IAAAA,SAAS,GAAGI,OAAO,CAACH,UAAD,CAAnB;AACD,GAJD,CAIE,OAAMI,CAAN,EAAS;AACT,QAAIA,CAAC,YAAYC,WAAjB,EAA8B;AAC5BC,MAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,KAAd;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACK,OAAd;AACD;AACF;;AAEDV,EAAAA,SAAS,GAAGW,aAAa,CAACX,SAAD,EAAYT,wBAAZ,CAAzB;AACA,SAAOS,SAAP;AACD;AAED;;;;;;;;;AAOO,SAASW,aAAT,CAAuBhB,MAAvB,EAA+BiB,QAA/B,EAAyC;AAC9C,QAAMZ,SAAS,GAAG,EAAE,GAAGL;AAAL,GAAlB;AAEAkB,EAAAA,MAAM,CAACC,OAAP,CAAeF,QAAf,EAAyBG,OAAzB,CAAiC,CAAC,CAACC,GAAD,EAAMC,MAAN,CAAD,KAAmB;AAClD,QAAI,OAAOA,MAAP,KAAkB,QAAlB,IAA8B,CAACC,KAAK,CAACC,OAAN,CAAcF,MAAd,CAAnC,EAA0D;AACxDjB,MAAAA,SAAS,CAACgB,GAAD,CAAT,GAAiBH,MAAM,CAACO,MAAP,CAAc,EAAd,EAAkBH,MAAlB,EAA0BjB,SAAS,CAACgB,GAAD,CAAT,IAAkB,EAA5C,CAAjB;AACD,KAFD,MAGK,IAAI,OAAOhB,SAAS,CAACgB,GAAD,CAAhB,IAAyB,WAA7B,EAA0C;AAC7ChB,MAAAA,SAAS,CAACgB,GAAD,CAAT,GAAiBC,MAAjB;AACD;AACF,GAPD;AASA,SAAOjB,SAAP;AACD","sourcesContent":["/**\n * Manages the command configuration files.\n *\n * If the `changelog.conf.js` file is in the directory the script is run in\n * these returned settings will overwrite the defaults.\n */\n\nimport fs from 'fs';\nimport path from 'path';\nimport program from 'commander';\n\n/**\n * Default config object\n */\nimport defaultConfig from '../changelog.config.js';\n\n\n/**\n * Name of the local config files.\n * Put this file in the directory where you call the jira-changelog command.\n */\nexport const CONF_FILENAME = 'changelog.config.js';\n\n/**\n * Return the default config object.\n * @return {Object}\n */\nexport function getDefaultConfig() {\n  return defaultConfig;\n}\n\n/**\n * Return the path to the config file\n * @param {String} cwd - The current directory\n * @return {String}\n */\nexport function configFilePath(cwd) {\n  // Passed in on the command line\n  if (program.config) {\n    return path.resolve(program.config);\n  }\n  return path.join(cwd, CONF_FILENAME);\n}\n\n/**\n * Reads the config file, merges it with the default values and returns the object.\n *\n * @param {String} cwd - The current directory\n * @return {Object} Configuration object.\n */\nexport function readConfigFile(cwd) {\n  let localConf = {};\n  const configPath = configFilePath(cwd);\n\n  try {\n    // Check if file exists\n    fs.accessSync(configPath);\n    localConf = require(configPath);\n  } catch(e) {\n    if (e instanceof SyntaxError) {\n      console.log('Error reading changelog.config.js:');\n      console.log(e.stack);\n      console.log(e.message);\n    }\n  }\n\n  localConf = defaultValues(localConf, defaultConfig);\n  return localConf;\n}\n\n/**\n * Add the default values into the config object\n *\n * @param {Object} config - The config object to merge with the default values.\n * @param {Object} defaults - The default object\n * @return {Object}\n */\nexport function defaultValues(config, defaults) {\n  const localConf = { ...config };\n\n  Object.entries(defaults).forEach(([key, defVal]) => {\n    if (typeof defVal === 'object' && !Array.isArray(defVal)) {\n      localConf[key] = Object.assign({}, defVal, localConf[key] || {});\n    }\n    else if (typeof localConf[key] == 'undefined') {\n      localConf[key] = defVal;\n    }\n  });\n\n  return localConf;\n}\n"],"file":"Config.js"}